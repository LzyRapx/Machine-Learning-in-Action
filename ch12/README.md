# Ch12 - 使用FP-growth算法来高效发现频繁项集(Efficiently finding frequent itemsets with FP-growth)

#### (Frequent Pattern)FP-growth算法是一种高效发现频繁集的方法。它比Apriori算法要快，这里的任务是将数据集存储在一个特定的称作FP树的结构之后发现频繁项集或者频繁项对，这种做法使得算法的执行速度要快于Apriori两个数量级以上。

#### FP-growth算法只需要对数据库进行两次扫描(第一次遍历：统计各个数据的频繁度(统计出现频率)，第二次遍历：只考虑那些频繁元素)，而Apriori算法对于每个潜在的频繁项集都会扫描数据集判定给定模式是否频繁，因此FP-growth算法的速度要比Apriori算法快。它发现频繁项集的基本过程如下： 
```
(1) 构建FP树 
(2) 从FP树中挖掘频繁项集 
```
#### FP-growth算法将数据存储在一种称为FP树的紧凑数据结构中。FP代表频繁模式(Frequent Pattern)。一棵FP树看上去与计算机科学中的其他树结构类似,但是它通过链接(link)来连接相似元素，被连起来的元素项可以看成一个链表。

#### 在创建真正的频繁集FP树之前，需要对数据进行过滤（不符合频繁要求）和排序（按照频繁度排序）。利用头指针表，可以快速访问FP树中一个给定类型的所有元素。 

#### 同搜索树不同的是,一个元素项可以在一棵FP树中出现多次。FP树会存储项集的出现频率,而每个项集会以路径的方式存储在树中。存在相似元素的集合会共享树的一部分。只有当集合之间完全不同时,树才会分叉。 树节点上给出集合中的单个元素及其在序列中的出现次数，路径会给出该序列的出现次数。

### 从FP树中抽取频繁项集的三个基本步骤如下:
```
(1) 从FP树中获得条件模式基;
(2) 利用条件模式基,构建一个条件FP树;
(3) 迭代重复步骤(1)步骤(2),直到树包含一个元素项为止。
```

## 条件模式基
#### 条件模式基是以所查找元素项为结尾的路径集合，每一条路径其实都是一条前缀路径。 抽取出来每个频繁项集的前缀路径之后，用条件模式基构造条件FP树（t的条件FP树）。简单来说，对于最简单的1个元素的，去掉不满足支持度的元素，选出长度1的频繁项集，然后把给出的元素序列，构造FP树，然后对于每个长度为1的频繁项集，找出条件模式基（前缀路径），然后根据前缀路径，去掉不满足支持度的元素，满足支持度的元素，加上原来长度1的频繁项集，就构成了长度2的频繁项集，以此类推。这个代码递归实现即可。

## 示例:从新闻网站点击流中挖掘
#### 在上传的源码中，有一个kosarak.dat文件，它包含将近100万条记录 。该文件中的每一行包含某个用户浏览过的新闻报道。一些用户只看过一篇报道,而有些用户看过2498篇报道，其中用户和报道被编码成整数。
```
# 需要创建一个空列表来保存这些频繁项集
myFreqList = []

# 执行该代码，构建树以及扫描100万行只需要几秒钟
mineTree(myFPtree, myHeaderTab, 100000, set([]), myFreqList)

# 看下有多少新闻报道或报道集合曾经被10万或者更多的人浏览过:
print len(myFreqList)# 查询结果为9人

# 看具体为哪9项：
print myFreqList
```
## 总结：
#### growth算法是一种用于发现数据集中频繁模式的有效方法。FP-growth算法利用Apriori原则，速度更快。在FP-growth算法中，数据集存储在一个称为FP树的结构中。FP树构建完成后，可以通过查找元素项的条件基及构建条件FP树来发现频繁项集。该过程不断以更多元素作为条件重复进行，直到FP树只包含一个元素为止。
#### 可以使用FP-growth算法在多种文本文档中查找频繁单词。频繁项集生成还有其他一些应用，比如购物交易，医学诊断，大气研究等。

